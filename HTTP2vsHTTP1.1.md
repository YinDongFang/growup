# HTTP/2 VS HTTP/1.1

### HTTP/2特性

1. 多路复用（连接共享）。可以实现同一个域名维持单个TCP连接，并在单个TCP连接上并行发送多个请求（全双工的通信方式）。
HTTP/2请求数据通过二进制分帧以流的形式在传输，每个请求对应一个流，有其自己的ID，流又由二进制帧组成，二进制帧首部会有标识，进而实现帧排序重新组装。
每个请求还可以携带请求的优先级数值，服务端和客户端可以对不同优先级请求使用不同的处理策略。
> HTTP/1.1采用文本传输，包括起始行，头部，实体部分，由换行符分割。
> 同个TCP连接发送多个请求时需要等待上一个请求返回响应，也就是请求-响应串行的方式**半双工的通信方式：可以双向通信，但是同一时间只能有一方占用通道进行传输**。
> 并行发送请求时，同一域名最多支持的TCP连接存在限制，Chrome一般为6个。
2. 头部压缩，通过HPACK压缩请求和响应数据标头，优化传输效率。通过霍夫曼压缩算法，客户端和服务端共同维护更新元数据表。
3. 服务器推送，服务器端可以通过配置实现主动推送资源文件到浏览器。Nginx从1.13.9开始支持服务器推送，参考文章：http://www.ruanyifeng.com/blog/2018/03/http2_server_push.html 。HTTP/1.1情况下打开网页需要先请求首页html文件，然后本地浏览器解析，再请求html内所需css和js文件，如果本地有缓存还好，服务器推送可以在打开页面时同时将css,js推送到客户端浏览器。浏览器端采取缓存优先的策略，再有缓存的情况下进行推送会浪费带宽，同时浏览器也需要进行多余处理，所以可以根据Cookie实现首次打开进行推送。
4. 取消数据流传输，通过发送`RST_STREAM`帧可以实现取消传输。
